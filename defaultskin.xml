<krpano>
	<!-- krpano 1.17.1 default buttons skin -->

	<!-- default mouse control mode (moveto or drag2d) -->
	<control mousetype="drag2d" />
	
	<!-- loading percent events -->
	
			<!-- onxmlcomplete="loadingpercent_startloading();" -->
			
			<!-- js(closeSplash()); -->

	<!-- loading percent graphics/text -->
<!-- 	<layer name="loadingpercent_text" keep="true"
	       url="%SWFPATH%/plugins/textfield.swf"
	       align="center"
	       background="false"
	       border="false"
	       autoheight="true"
	       css="text-align:center; color:#FFFFFF; font-family:Gotham-Light; font-weight:bold; font-size:30px;"
	       html=""
		   y="14%"
	       /> -->

	
	<!-- loading percent actions -->	
	<!-- <action name="loadingpercent_startloading">
		set(loadingpercent_isloading, true);
		set(layer[loadingpercent_text].visible, true);
		
		asyncloop(loadingpercent_isloading,
			mul(pv, progress.progress, 100);
			roundval(pv,0);
			txtadd(layer[loadingpercent_text].html, get(pv), '%');
		  );
	</action>
	
	<action name="loadingpercent_stoploading">
		set(loadingpercent_isloading, false); 
		delayedcall(0.2, tween(layer[loadingpercent_text].alpha, 0, 1););
		delayedcall(1.2, set(layer[loadingpercent_text].visible, false););
	</action> -->

<!-- //speed="3.0" waittime="5"  />	 -->
	
	
	<action name="get-transcript-text">
		for(set(j, 0), j LT hotspot.count, inc(j),
		if(hotspot[get(j)].id == hotspotsName,					
			if(hotspot[get(j)].extra == "true",
			set(notesHotspot,get(j));
			trace("notes true");
			);
		);
		);
	</action>	

<action name="hotspots-test">
	for(set(i, 0), i LT hotspot.count, inc(i),
	if(hotspot[get(i)].id == hotspotsName,
				set(hotspot[get(i)].visible, true);

				
				for(set(j, get(i)), j LT hotspot.count, inc(j),
					if(hotspot[get(j)].id == hotspotsName,
					
					set(hotspot[get(j)].visible, true);
					,
					set(hotspot[get(j)].visible, false);
					);
				);
				set(ii, get(i));
				delayedcall(0.2, looktohotspot(get(ii), 60,smooth(120,80,150)););
				set(i, get(hotspot.count));
				,
				set(hotspot[get(i)].visible, false);
		);
	);					
</action>
<action name="hide-hotspots">
	for(set(i, 0), i LT hotspot.count, inc(i),set(hotspot[get(i)].visible, false));
</action>


<action name="gyro_icon_switch">
	if(plugin[skin_gyro].enabled,
		set(layer[skin_btn_gyro].crop, get(fcrop))
		,
		set(layer[skin_btn_gyro].crop, get(ncrop)));
</action>

<skin_settings bingmaps="false"
	               bingmaps_key=""
	               bingmaps_zoombuttons="false"
	               gyro="true"
	               thumbs_width="120" thumbs_height="80" thumbs_padding="10" thumbs_crop="0|40|240|160"
	               thumbs_opened="false"
	               thumbs_text="false"
	               thumbs_dragging="true"
	               thumbs_onhoverscrolling="false"
	               thumbs_scrollbuttons="false"
	               thumbs_scrollindicator="false"
	               tooltips_thumbs="false"
	               tooltips_hotspots="false"
	               tooltips_mapspots="false"
	               controlbar_offset="20"
	               />
				   
	<!-- Skin Styles -->

<!-- CUSTOM STYLES --> 

<style name="hotspot1" url="images/hotspots/hotspot1.png" edge="bottom" />
<style name="hotspot1" url="images/hotspots/hotspot1@2x.png" devices="Retina" />

<style name="hotspot1a" url="images/hotspots/hotspot1a.png" edge="bottom" />
<style name="hotspot1a" url="images/hotspots/hotspot1a@2x.png" devices="Retina" />

<style name="hotspot1b" url="images/hotspots/hotspot1b.png" edge="bottom" />
<style name="hotspot1b" url="images/hotspots/hotspot1b@2x.png" devices="Retina" />

<style name="hotspot2" url="images/hotspots/hotspot2.png" edge="bottom" />
<style name="hotspot2" url="images/hotspots/hotspot2@2x.png" devices="Retina" />

<style name="hotspot3" url="images/hotspots/hotspot3.png" edge="bottom" />
<style name="hotspot3" url="images/hotspots/hotspot3@2x.png" devices="Retina" />

<style name="hotspot4" url="images/hotspots/hotspot4.png" edge="bottom" />
<style name="hotspot4" url="images/hotspots/hotspot4@2x.png" devices="Retina" />

<style name="hotspot5" url="images/hotspots/hotspot5.png" edge="bottom" />
<style name="hotspot5" url="images/hotspots/hotspot5@2x.png" devices="Retina" />

<style name="hotspot6" url="images/hotspots/hotspot6.png" edge="bottom" />
<style name="hotspot6" url="images/hotspots/hotspot6@2x.png" devices="Retina" />

<style name="hotspot6a" url="images/hotspots/hotspot6a.png" edge="bottom" />
<style name="hotspot6a" url="images/hotspots/hotspot6a@2x.png" devices="Retina" />

<style name="hotspot6b" url="images/hotspots/hotspot6b.png" edge="bottom" />
<style name="hotspot6b" url="images/hotspots/hotspot6b@2x.png" devices="Retina" />

<style name="hotspot7" url="images/hotspots/hotspot7.png" edge="bottom" />
<style name="hotspot7" url="images/hotspots/hotspot7@2x.png" devices="Retina" />

<style name="hotspot8" url="images/hotspots/hotspot8.png" edge="bottom" />
<style name="hotspot8" url="images/hotspots/hotspot8@2x.png" devices="Retina" />

<style name="hotspot9" url="images/hotspots/hotspot9.png" edge="bottom" />
<style name="hotspot9" url="images/hotspots/hotspot9@2x.png" devices="Retina" />

<style name="hotspot9a" url="images/hotspots/hotspot9a.png" edge="bottom" />
<style name="hotspot9a" url="images/hotspots/hotspot9a@2x.png" devices="Retina" />

<style name="hotspot9b" url="images/hotspots/hotspot9b.png" edge="bottom" />
<style name="hotspot9b" url="images/hotspots/hotspot9b@2x.png" devices="Retina" />

<style name="hotspot10" url="images/hotspots/hotspot10.png" edge="bottom" />
<style name="hotspot10" url="images/hotspots/hotspot10@2x.png" devices="Retina" />

<style name="hotspot11" url="images/hotspots/hotspot11.png" edge="bottom" />
<style name="hotspot11" url="images/hotspots/hotspot11@2x.png" devices="Retina" />

<style name="hotspot12" url="images/hotspots/hotspot12.png" edge="bottom" />
<style name="hotspot12" url="images/hotspots/hotspot12@2x.png" devices="Retina" />

<style name="hotspot12a" url="images/hotspots/hotspot12a.png" edge="bottom" />
<style name="hotspot12a" url="images/hotspots/hotspot12a@2x.png" devices="Retina" />

<style name="hotspot12b" url="images/hotspots/hotspot12b.png" edge="bottom" />
<style name="hotspot12b" url="images/hotspots/hotspot12b@2x.png" devices="Retina" />

<style name="hotspot13" url="images/hotspots/hotspot13.png" edge="bottom" />
<style name="hotspot13" url="images/hotspots/hotspot13@2x.png" devices="Retina" />

<style name="hotspot14" url="images/hotspots/hotspot14.png" edge="bottom" />
<style name="hotspot14" url="images/hotspots/hotspot14@2x.png" devices="Retina" />

<style name="hotspot15" url="images/hotspots/hotspot15.png" edge="bottom" />
<style name="hotspot15" url="images/hotspots/hotspot15@2x.png" devices="Retina" />

<style name="hotspot16" url="images/hotspots/hotspot16.png" edge="bottom" />
<style name="hotspot16" url="images/hotspots/hotspot16@2x.png" devices="Retina" />

<style name="hotspot17" url="images/hotspots/hotspot17.png" edge="bottom" />
<style name="hotspot17" url="images/hotspots/hotspot17@2x.png" devices="Retina" />

<style name="hotspot17a" url="images/hotspots/hotspot17a.png" edge="bottom" />
<style name="hotspot17a" url="images/hotspots/hotspot17a@2x.png" devices="Retina" />

<style name="hotspot17b" url="images/hotspots/hotspot17b.png" edge="bottom" />
<style name="hotspot17b" url="images/hotspots/hotspot17b@2x.png" devices="Retina" />

<style name="hotspot17c" url="images/hotspots/hotspot17c.png" edge="bottom" />
<style name="hotspot17c" url="images/hotspots/hotspot17c@2x.png" devices="Retina" />

<style name="hotspot18" url="images/hotspots/hotspot18.png" edge="bottom" />
<style name="hotspot18" url="images/hotspots/hotspot18@2x.png" devices="Retina" />

<style name="hotspot19" url="images/hotspots/hotspot19.png" edge="bottom" />
<style name="hotspot19" url="images/hotspots/hotspot19@2x.png" devices="Retina" />

<style name="hotspot20" url="images/hotspots/hotspot20.png" edge="bottom" />
<style name="hotspot20" url="images/hotspots/hotspot20@2x.png" devices="Retina" />

<style name="hotspot21" url="images/hotspots/hotspot21.png" edge="bottom" />
<style name="hotspot21" url="images/hotspots/hotspot21@2x.png" devices="Retina" />

<style name="hotspot22" url="images/hotspots/hotspot22.png" edge="bottom" />
<style name="hotspot22" url="images/hotspots/hotspot22@2x.png" devices="Retina" />

<style name="hotspot23" url="images/hotspots/hotspot23.png" edge="bottom" />
<style name="hotspot23" url="images/hotspots/hotspot23@2x.png" devices="Retina" />

<style name="hotspot24" url="images/hotspots/hotspot24.png" edge="bottom" />
<style name="hotspot24" url="images/hotspots/hotspot24@2x.png" devices="Retina" />

<style name="hotspot25" url="images/hotspots/hotspot25.png" edge="bottom" />
<style name="hotspot25" url="images/hotspots/hotspot25@2x.png" devices="Retina" />

<style name="hotspot26" url="images/hotspots/hotspot26.png" edge="bottom" />
<style name="hotspot26" url="images/hotspots/hotspot26@2x.png" devices="Retina" />

<style name="hotspot27" url="images/hotspots/hotspot27.png" edge="bottom" />
<style name="hotspot27" url="images/hotspots/hotspot27@2x.png" devices="Retina" />

<style name="hotspot28" url="images/hotspots/hotspot28.png" edge="bottom" />
<style name="hotspot28" url="images/hotspots/hotspot28@2x.png" devices="Retina" />

<style name="hotspot29" url="images/hotspots/hotspot29.png" edge="bottom" />
<style name="hotspot29" url="images/hotspots/hotspot29@2x.png" devices="Retina" />

<style name="hotspot30" url="images/hotspots/hotspot30.png" edge="bottom" />
<style name="hotspot30" url="images/hotspots/hotspot30@2x.png" devices="Retina" />

<style name="hotspot31" url="images/hotspots/hotspot31.png" edge="bottom" />
<style name="hotspot31" url="images/hotspots/hotspot31@2x.png" devices="Retina" />

<style name="hotspot32" url="images/hotspots/hotspot32.png" edge="bottom" />
<style name="hotspot32" url="images/hotspots/hotspot32@2x.png" devices="Retina" />

<style name="hotspot33" url="images/hotspots/hotspot33.png" edge="bottom" />
<style name="hotspot33" url="images/hotspots/hotspot33@2x.png" devices="Retina" />

<style name="hotspot34" url="images/hotspots/hotspot34.png" edge="bottom" />
<style name="hotspot34" url="images/hotspots/hotspot34@2x.png" devices="Retina" />

<style name="hotspot35" url="images/hotspots/hotspot35.png" edge="bottom" />
<style name="hotspot35" url="images/hotspots/hotspot35@2x.png" devices="Retina" />

<style name="hotspot36" url="images/hotspots/hotspot36.png" edge="bottom" />
<style name="hotspot36" url="images/hotspots/hotspot36@2x.png" devices="Retina" />

<style name="hotspot37" url="images/hotspots/hotspot37.png" edge="bottom" />
<style name="hotspot37" url="images/hotspots/hotspot37@2x.png" devices="Retina" />

<style name="hotspot38" url="images/hotspots/hotspot38.png" edge="bottom" />
<style name="hotspot38" url="images/hotspots/hotspot38@2x.png" devices="Retina" />

<style name="hotspot39" url="images/hotspots/hotspot39.png" edge="bottom" />
<style name="hotspot39" url="images/hotspots/hotspot39@2x.png" devices="Retina" />

<style name="hotspot40" url="images/hotspots/hotspot40.png" edge="bottom" />
<style name="hotspot40" url="images/hotspots/hotspot40@2x.png" devices="Retina" />

<style name="hotspot41" url="images/hotspots/hotspot41.png" edge="bottom" />
<style name="hotspot41" url="images/hotspots/hotspot41@2x.png" devices="Retina" />

<style name="hotspot42" url="images/hotspots/hotspot42.png" edge="bottom" />
<style name="hotspot42" url="images/hotspots/hotspot42@2x.png" devices="Retina" />





	<style name="hotspot-check" visible="false" width="91" height="91" scale="0.75" />


	<!-- Skin Layout -->
	<layer name="skin_control_bar" keep="true" type="container" align="leftbottom" width="100%" height="40" x="0" y="20" y_opened="20" y_closed="-42" zorder="3">

	<layer name="skin_btn_gyro" url="images/gyro.png"    
			crop="0|0|90|90" 
			ncrop="0|0|90|90"
			fcrop="90|0|90|90"
			align="rightbottom"  
			alpha="0.6"   
			x="25" 
			y="4"   
			scale="1"  
			onover="tween(alpha,1,0.5);" 
			onout="tween(alpha,0.6,0.5);" 
			ondown2="skin_showmap(false);" 
			onclick="switch(plugin[skin_gyro].enabled);gyro_icon_switch();" 
			visible="false"
			devices="html5" 
	/>
	<layer name="skin_btn_gyro" url="images/gyro@2x.png" 
			devices="Retina" 
			scale="0.5"
			crop="0|0|180|180" 
			ncrop="0|0|180|180"
			fcrop="180|0|180|180"
			x="25" y="4"
	/>
	
	</layer>

<!-- 	<layer name="skin_loadingtext"  keep="true" align="center" x="5" y="-5" visible="false" url="images/ael_logo.png" width="400" height="61" />
	<layer name="skin_loadingtext"  devices="Retina" url="images/ael_logo@2x.png" width="400" height="61" />
	 -->
	<plugin name="skin_gyro"        keep="true" url="" html5_url="%SWFPATH%/plugins/gyro.js" devices="html5+!firefox+!android" enabled="false" camroll="true" friction="0" velastic="0" onavailable="if(device.fullscreensupport, if(device.mobile,add(layer[skin_btn_gyro].x,40),add(layer[skin_btn_gyro].x,20));); set(layer[skin_btn_gyro].visible,true);" />


	<!-- Skin Events -->

	<events name="skin_events" keep="true"
	        onxmlcomplete="set(events[skin_events].onxmlcomplete,null); skin_startup(); "
	        onnewpano="skin_showloading(true); skin_update_scene_infos();"
	        onremovepano="skin_showloading(true);"
	        onloadcomplete="skin_showloading(false);"
	        onresize="skin_onresize();"
	        />

	<events name="skin_events" devices="fullscreensupport"
	        onenterfullscreen="set(layer[skin_btn_fs].crop, '64|576|64|64');"
	        onexitfullscreen="set(layer[skin_btn_fs].crop, '0|576|64|64');"
	        />


	<!-- Alternative small screen layout for mobile devices (override/extend settings) -->


	<!-- Skin Actions -->

	<action name="skin_startup">
		if(device.mobile == false,
			copy(layer[skin_control_bar].y, skin_settings.controlbar_offset);
			copy(layer[skin_control_bar].y_opened, skin_settings.controlbar_offset);
			add(layer[skin_scroll_window].y, layer[skin_control_bar].height, layer[skin_control_bar].y);
			add(layer[skin_scroll_window].y_opened, layer[skin_control_bar].height, layer[skin_control_bar].y_opened);

			if(skin_settings.thumbs_opened, set(layer[skin_thumbs].state,'opened'); set(layer[skin_thumbs_container].visible,true); );

			copy(layer[skin_thumbs].draggable, skin_settings.thumbs_dragging);

			if(skin_settings.thumbs_onhoverscrolling,
				ifnot(device.touchdevice, set(layer[skin_thumbs].draggable, false));
				set(layer[skin_thumbs].onhover_autoscrolling, true);
			  );
		  );


		skin_addthumbs();
		skin_onresize();
		skin_updatescroll();

		copy(usegyro, skin_settings.gyro);
		if(device.desktop, set(usegyro, false));
		if(device.flash, set(usegyro, false));
		if(usegyro, copy(plugin[skin_gyro].url, plugin[skin_gyro].html5_url); );

		if(skin_settings.bingmaps == true,
			set(layer[skin_btn_map].visible, true);
			copy(layer[skin_map].key, skin_settings.bingmaps_key);
			copy(layer[skin_map_zoom_in].visible,  skin_settings.bingmaps_zoombuttons);
			copy(layer[skin_map_zoom_out].visible, skin_settings.bingmaps_zoombuttons);
			if(device.flash, copy(layer[skin_map].url, layer[skin_map].flash_url), copy(layer[skin_map].url, layer[skin_map].html5_url) );
		  ,
			if(device.mobile, copy(layer[skin_btn_gyro].x, layer[skin_btn_map].x) );
		  );
	</action>

	<action name="skin_addthumbs">
		copy(thumbwidth, skin_settings.thumbs_width);
		copy(thumbheight, skin_settings.thumbs_height);
		copy(thumbpadding, skin_settings.thumbs_padding);
		copy(thumbcrop, skin_settings.thumbs_crop);

		if(device.mobile,
			mul(thumbwidth,2);
			mul(thumbheight,2);
			mul(thumbpadding,2);
		  );

		add(thumbxoffset, thumbwidth, thumbpadding);
		mul(thumbxcenter, thumbxoffset, 0.5);
		mul(thumbbarwidth, thumbxoffset, scene.count);
		add(thumbbarwidth, thumbpadding);
		add(thumbbarheight, thumbpadding, thumbheight);
		add(thumbbarheight, thumbpadding);

		if (skin_settings.thumbs_scrollindicator,
			copy(layer[skin_thumbs_scrollindicator].y, thumbbarheight);
			add(thumbbarheight, layer[skin_thumbs_scrollindicator].height);
		);

		copy(layer[skin_thumbs].height, thumbbarheight);
		copy(layer[skin_thumbs].width, thumbbarwidth);

		mul(halfheight, thumbbarheight, 0.5);
		copy(layer[skin_thumbs_scrollleft].y, halfheight);
		copy(layer[skin_thumbs_scrollright].y, halfheight);

		for(set(i,0), i LT scene.count, inc(i),
			txtadd(thumbname,'skin_thumb_',get(i));
			addlayer(get(thumbname));
			copy(layer[get(thumbname)].url, scene[get(i)].thumburl);
			set(layer[get(thumbname)].keep, true);
			set(layer[get(thumbname)].parent, 'skin_thumbs');
			set(layer[get(thumbname)].align, lefttop);
			copy(layer[get(thumbname)].crop, thumbcrop);
			copy(layer[get(thumbname)].width, thumbwidth);
			copy(layer[get(thumbname)].height, thumbheight);
			mul(thumbx, i, thumbxoffset);
			add(thumbx, thumbpadding);
			copy(layer[get(thumbname)].x, thumbx);
			copy(layer[get(thumbname)].y, thumbpadding);
			add(scene[get(i)].thumbx, thumbx, thumbxcenter);
			copy(scene[get(i)].thumby, thumbpadding);
			set(layer[get(thumbname)].linkedscene, get(scene[get(i)].name) );
			set(layer[get(thumbname)].onclick, copy(layer[skin_thumbborder].parent, name); loadscene(get(linkedscene), null, MERGE, BLEND(0.5)); );
			if(skin_settings.tooltips_thumbs,
				set(layer[get(thumbname)].onhover, showtext(get(scene[get(linkedscene)].title),SKIN_TOOLTIPS); );
			  );
			if(skin_settings.thumbs_text,
				txtadd(thumbtext, 'skin_thumbtext_', get(i));
				addlayer(get(thumbtext));
				layer[get(thumbtext)].loadstyle(skin_thumbtext_style);
				set(layer[get(thumbtext)].keep, true);
				set(layer[get(thumbtext)].parent, get(thumbname));
				set(layer[get(thumbtext)].html, get(scene[get(i)].title));
			  );
		   );
	</action>

	<action name="skin_addmapspots">
		for(set(i,0), i LT scene.count, inc(i),
			if(scene[get(i)].lat,
				txtadd(spotname, 'spot', get(i));
				txtadd(spotclickevent, 'activatespot(',get(spotname),'); loadscene(', get(scene[get(i)].name), ',null,MERGE,BLEND(1)); skin_updatescroll(); delayedcall(0.5,skin_showmap(false));');
				copy(scene[get(i)].mapspotname, spotname);
				if(skin_settings.tooltips_mapspots, escape(spottitle,get(scene[get(i)].title)); txtadd(spothoverevent,'showtext(',get(spottitle),',SKIN_TOOLTIPS)'); , set(spothoverevent,null); );

				addspot(get(spotname), get(scene[get(i)].lat), get(scene[get(i)].lng), get(scene[get(i)].heading), false, get(spotclickevent), get(spothoverevent));
			  );
		  );
		activatespot(spot0);
		zoomToSpotsExtent();
	</action>

	<action name="skin_onresize">
		mul(mh, stageheight, -1);
		if(layer[skin_thumbs].state == 'opened', add(mh,layer[skin_thumbs].height); );
		if(layer[skin_map].state == 'opened', sub(hh,stageheight,skin_settings.controlbar_offset); sub(hh,layer[skin_control_bar].height); sub(hh,32); copy(layer[skin_map].height, hh); add(mh,hh); );
		set(layer[skin_scroll_layer].y, get(mh));
		ifnot(device.mobile, if(stagewidth LT 480, skin_showbuttons(false), skin_showbuttons(true)); );
	</action>

	<action name="skin_showbuttons">
		set(layer[skin_btn_lt].visible, %1);
		set(layer[skin_btn_rt].visible, %1);
		set(layer[skin_btn_up].visible, %1);
		set(layer[skin_btn_dn].visible, %1);
		set(layer[skin_btn_in].visible, %1);
		set(layer[skin_btn_ou].visible, %1);
		if(%1 == true,
			if(plugin[skin_gyro].available == true, set(layer[skin_btn_gyro].visible, %1) );
			if(device.fullscreensupport, set(layer[skin_btn_fs].visible, %1) );
		  ,
			set(layer[skin_btn_gyro].visible, %1);
			set(layer[skin_btn_fs].visible, %1);
		  );
	</action>

	<action name="skin_updatescroll">
		if(layer[skin_thumbs].loaded,
			set(cursceneindex, 0);
			if(xml.scene, copy(cursceneindex, scene[get(xml.scene)].index));
			layer[skin_thumbs].setcenter(get(scene[get(cursceneindex)].thumbx), get(scene[get(cursceneindex)].thumby));
		  );
	</action>

	<action name="skin_updatethumbscroll">
		copy(padding,skin_settings.thumbs_padding);
		if(device.mobile, mul(padding,2));

		if(skin_settings.thumbs_scrollbuttons,
			if(loverflow GT 0, set(layer[skin_thumbs_scrollleft].visible,true),  set(layer[skin_thumbs_scrollleft].visible,false) );
			if(roverflow GT 0, set(layer[skin_thumbs_scrollright].visible,true), set(layer[skin_thumbs_scrollright].visible,false) );
		  );

		if(skin_settings.thumbs_scrollindicator,
			if(woverflow GT 0,
				set(layer[skin_thumbs_scrollindicator].visible,true);
				sub(iw,pixelwidth,woverflow);
				div(pw,iw,pixelwidth);
				div(px,loverflow,woverflow);
				mul(pw,iw);
				copy(layer[skin_thumbs_scrollindicator].width,pw);
				sub(iw,pw);
				sub(iw,padding);
				sub(iw,padding);
				mul(px,iw);
				add(px,padding);
				copy(layer[skin_thumbs_scrollindicator].x,px);
			  ,
				set(layer[skin_thumbs_scrollindicator].visible,false);
			  );
		  );
	</action>

	<action name="skin_update_scene_infos">
		if(xml.scene != null,
			if(title, txtadd(layer[skin_title].html, get(title), ' - ', get(scene[get(xml.scene)].title) ); , copy(layer[skin_title].html, scene[get(xml.scene)].title ); );
			delayedcall(0.1, set(layer[skin_title].visible,true) );
	
			if(scene[get(xml.scene)].index GT 0,
				set(layer[skin_btn_prev].enabled, true);
				set(layer[skin_btn_prev].alpha, 1.0);
			  ,
				set(layer[skin_btn_prev].enabled, false);
				set(layer[skin_btn_prev].alpha, 0.3);
			  );
	
			sub(lastsceneindex, scene.count, 1);
			if(scene[get(xml.scene)].index LT lastsceneindex,
				set(layer[skin_btn_next].enabled, true);
				set(layer[skin_btn_next].alpha, 1.0);
			  ,
				set(layer[skin_btn_next].enabled, false);
				set(layer[skin_btn_next].alpha, 0.3);
			  );
	
			txtadd(layer[skin_thumbborder].parent, 'skin_thumb_', get(scene[get(xml.scene)].index));
			set(layer[skin_thumbborder].visible, true);
	
			if(scene[get(xml.scene)].mapspotname,
				layer[skin_map].activatespot(get(scene[get(xml.scene)].mapspotname));
				layer[skin_map].pantospot(get(scene[get(xml.scene)].mapspotname));
			  );
		  );
	</action>

	<action name="skin_nextscene">
		add(newsceneindex, scene[get(xml.scene)].index, %1);
		if(newsceneindex GE 0,
			if(newsceneindex LT scene.count,
				txtadd(layer[skin_thumbborder].parent, 'skin_thumb_', get(newsceneindex));
				layer[skin_thumbs].scrolltocenter(get(scene[get(newsceneindex)].thumbx), get(scene[get(newsceneindex)].thumby));
				loadscene(get(scene[get(newsceneindex)].name), null, MERGE, BLEND(0.5));
			  );
		  );
	</action>

	<action name="skin_nextscene_loop">
		add(newsceneindex, scene[get(xml.scene)].index, %1);
		sub(lastsceneindex, scene.count, 1);
		if(newsceneindex LT 0, copy(newsceneindex,lastsceneindex));
		if(newsceneindex GT lastsceneindex, set(newsceneindex,0));
		layer[skin_thumbs].scrolltocenter(get(scene[get(newsceneindex)].thumbx), get(scene[get(newsceneindex)].thumby));
		loadscene(get(scene[get(newsceneindex)].name), null, MERGE, BLEND(0.5));
	</action>

	<action name="skin_showloading">
		if(%1 == true, set(layer[skin_loadingtext].visible, %1);
			,
			delayedcall(0.2,tween(layer[skin_loadingtext].alpha, 0, 1););
			delayedcall(1.2, set(layer[skin_loadingtext].visible, %1););		
		);
	</action>

	<action name="skin_buttonglow">
		if(%1 != null,
			set(strength,0.7);
			if(%2 != null, set(strength,%2));
			set(layer[skin_buttonglow].parent, %1);
			set(layer[skin_buttonglow].visible, true);
			tween(layer[skin_buttonglow].alpha, get(strength), 0.07);
		  ,
			tween(layer[skin_buttonglow].alpha, 0.0, 0.1, default, set(layer[skin_buttonglow].parent, null); set(layer[skin_buttonglow].visible, false); );
		  );
	</action>

	<action name="skin_hideskin">
		if(layer[skin_map].state != 'closed', skin_showmap(false); wait(0.4); );
		if(layer[skin_thumbs].state != 'closed', skin_showthumbs(false); wait(0.25); );
		tween(layer[skin_scroll_window].y, get(layer[skin_scroll_window].y_closed), 0.5, easeOutQuint);
		tween(layer[skin_control_bar].y, get(layer[skin_control_bar].y_closed), 0.5, easeOutQuint);
		set(layer[skin_btn_show].visible,true);
		tween(layer[skin_btn_show].alpha, 1, 0.25, easeOutQuint);
	</action>

	<action name="skin_showskin">
		tween(layer[skin_scroll_window].y, get(layer[skin_scroll_window].y_opened), 0.5, easeOutQuint);
		tween(layer[skin_control_bar].y, get(layer[skin_control_bar].y_opened), 0.5, easeOutQuint);
		set(layer[skin_btn_show].visible,false);
		tween(layer[skin_btn_show].alpha,0,0);
	</action>

	<action name="skin_showthumbs">
		if(%1 == null, if(layer[skin_thumbs].state == 'closed', set(show,true), set(show,false)); , set(show,%1); );
		mul(mh, layer[skin_scroll_layer].pixelheight, -1);
		if(layer[skin_scroll_layer].y == -100%, copy(layer[skin_scroll_layer].y,mh));
		if(show,
			set(layer[skin_thumbs].state, 'opened');
			add(mh, layer[skin_thumbs].height);
			tween(layer[skin_scroll_layer].y, get(mh), 0.5, easeOutQuint);
			set(layer[skin_thumbs_container].visible, true);
			tween(layer[skin_thumbs_container].alpha, 1.0, 0.25);
			tween(layer[skin_map].alpha, 0.0, 0.25, default, set(layer[skin_map].visible,false));
		  ,
			set(layer[skin_thumbs].state, 'closed');
			tween(layer[skin_scroll_layer].y, get(mh), 0.5, easeOutQuint, set(layer[skin_thumbs_container].visible, false););
		  );
	</action>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

	<!-- events for handling dynamic changes -->
	<!-- <events name="defaultskin_buttons" keep="true"
	        onxmlcomplete="update_ctrl_mode(); update_fs_button();"
	        onresize="adjust_button_sizes();"
	        onenterfullscreen="update_fs_button();"
	        onexitfullscreen ="update_fs_button();"
	        /> -->


	<!-- check if the buttons fit inside the window, and if not, make them smaller so that they will fit -->
	<!-- <action name="adjust_button_sizes">
		if(layer[defaultskin_buttons].pixelwidth GT stagewidth,
			div(layer[defaultskin_buttons].scale, stagewidth, layer[defaultskin_buttons].width);
		  );
	</action> -->

	<!-- update the buttons and the cursors according to the current control mode setting -->
	<action name="update_ctrl_mode">
		if(control.mousetype == drag2d,
			<!-- set mouse cursor graphic -->
			set(cursors.url, %SWFPATH%/skin/drag-cursors-2.png);
			set(cursors.type, drag);
			set(cursors.move,  0|0|32|32);
			set(cursors.drag, 32|0|32|32);
			<!-- set button graphic -->
			set(layer[btn_ctrlmode].crop,       720|0|80|80);
			set(layer[btn_ctrlmode].onovercrop, 720|80|80|80);
		  ,
			<!-- set mouse cursor graphic -->
			set(cursors.url, %SWFPATH%/skin/qtvr-cursors.png);
			set(cursors.type, 8way);
			set(cursors.move,       0|0|16|16);
			set(cursors.drag,      16|0|16|16);
			set(cursors.arrow_u,   32|0|16|16);
			set(cursors.arrow_d,   48|0|16|16);
			set(cursors.arrow_l,   64|0|16|16);
			set(cursors.arrow_r,   80|0|16|16);
			set(cursors.arrow_lu,  96|0|16|16);
			set(cursors.arrow_ru, 112|0|16|16);
			set(cursors.arrow_rd, 128|0|16|16);
			set(cursors.arrow_ld, 144|0|16|16);
			<!-- set button graphic -->
			set(layer[btn_ctrlmode].crop,       800|0|80|80);
			set(layer[btn_ctrlmode].onovercrop, 800|80|80|80);
		  );
	</action>

	<!-- update the fullscreen button according to the current state -->
	<!-- <action name="update_fs_button">
		if(fullscreen,
			set(layer[btn_fs].crop,       640|0|80|80);
			set(layer[btn_fs].onovercrop, 640|80|80|80);
		  ,
			set(layer[btn_fs].crop,       560|0|80|80);
			set(layer[btn_fs].onovercrop, 560|80|80|80);
		  );
	</action> -->


	<!-- context menu -->
	<contextmenu>
	<!-- 	<item name="krp" caption="KRPANO"     />
		<item name="fsc" caption="FULLSCREEN" /> -->
		<item name="scm" caption="Change Controlmode" onclick="switch(control.mousetype,moveto,drag2d); switch(control.touchtype,moveto,drag2d); update_ctrl_mode();" separator="true" />
		<!-- <item name="nrm" caption="Normal View"        onclick="skin_view_normal();"        showif="view.vlookatrange == 180" separator="true"      />
		<item name="fis" caption="Fisheye View"       onclick="skin_view_fisheye();"       showif="view.vlookatrange == 180" devices="flash|webgl" />
		<item name="ste" caption="Stereographic View" onclick="skin_view_stereographic();" showif="view.vlookatrange == 180" devices="flash|webgl" />
		<item name="arc" caption="Architectural View" onclick="skin_view_architectural();" showif="view.vlookatrange == 180"                       />
		<item name="pan" caption="Pannini View"       onclick="skin_view_pannini();"       showif="view.vlookatrange == 180" devices="flash|webgl" />
		<item name="lpv" caption="Little Planet View" onclick="skin_view_littleplanet();"  showif="view.vlookatrange == 180" devices="flash|webgl" /> -->
	</contextmenu>


	<!-- actions for view changing -->
	<!-- <action name="skin_view_normal">
		tween(view.fovmax,       150.0, distance(179, 1.00), easeoutquad);
		tween(view.architectural,  0.0, distance(1.0, 0.45), easeoutquad);
		tween(view.fisheye,        0.0, distance(1.0, 0.45), easeoutquad, set(view.stereographic,false); if(view.pannini, set(view.pannini,false); delayedcall(0,updateobject(true,true)); ); );
		set(centerview,false);
		if(view.architectural LT 0.2,
			if(view.vlookat LT -60, set(centerview,true));
			if(view.vlookat GT +60, set(centerview,true));
			if(centerview, tween(view.vlookat, 0.0, distance(90, 0.45), easeoutquad));
		  );
		if(view.fov GE 150, tween(view.fov, 100.0, distance(50, 0.45), easeoutquad));
	</action>
	
	<action name="skin_view_fisheye">
		tween(view.architectural, 0.0, distance(1.0, 0.30), easeoutquad);
		tween(view.fisheye,       0.0 ,distance(1.0, 0.30), easeoutquad, set(view.stereographic,false); if(view.pannini, set(view.pannini,false); delayedcall(0,updateobject(true,true)); ); set(view.fovmax,179); tween(view.fisheye, 0.35, distance(1.0,1.25)); );
	</action>
	
	<action name="skin_view_architectural">
		tween(view.fovmax,       150.0, distance(179, 1.00), easeoutquad);
		tween(view.architectural,  1.0, distance(1.0, 0.45), easeoutquad);
		tween(view.fisheye,        0.0, distance(1.0, 0.45), easeoutquad, set(view.stereographic,false); if(view.pannini, set(view.pannini,false); delayedcall(0,updateobject(true,true)); ); );
	</action>
	
	<action name="skin_view_stereographic">
		tween(view.architectural, 0.0, 0.25);
		set(backtonormalfirst, false);
		if(view.pannini       == true,  set(backtonormalfirst, true) );
		if(view.stereographic == false, set(backtonormalfirst, true) );
		if(backtonormalfirst, tween(view.fisheye, 0.0 ,distance(1.0, 0.25), easeoutquad, WAIT); );
		if(view.pannini, set(view.pannini,false); delayedcall(0,updateobject(true,true)); );
		set(view.stereographic, true);
		set(view.fovmax, 150);
		tween(view.fisheye, 1.0, distance(1.0, 0.75), easeoutquad);
	</action>
	
	<action name="skin_view_pannini">
		tween(view.architectural, 0.0, 0.25);
		set(backtonormalfirst, false);
		if(view.pannini       == false, set(backtonormalfirst, true) );
		if(view.stereographic == false, set(backtonormalfirst, true) );
		if(backtonormalfirst, tween(view.fisheye, 0.0 ,distance(1.0, 0.25), easeoutquad, WAIT); );
		set(view.pannini, true);
		set(view.stereographic, true);
		set(view.fovmax, 150);
		tween(view.fisheye, 1.0, distance(1.0, 0.75), easeoutquad);
	</action>
	
	<action name="skin_view_littleplanet">
		tween(view.architectural, 0.0, 0.25);
		tween(view.vlookat,  90, distance(179, 1.50), easeoutquad);
		set(backtonormalfirst, false);
		if(view.pannini       == true,  set(backtonormalfirst, true) );
		if(view.stereographic == false, set(backtonormalfirst, true) );
		if(backtonormalfirst, tween(view.fisheye, 0.0 ,distance(1.0, 0.25), easeoutquad, WAIT); );
		if(view.pannini, set(view.pannini,false); delayedcall(0,updateobject(true,true)); );
		set(view.stereographic, true);
		set(view.fovmax, 150);
		tween(view.fisheye, 1.0, distance(1.0, 0.75), easeoutquad);
		tween(view.fov,     150, distance(179, 0.75), easeoutquad);
	</action> -->

</krpano>
